<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.7.0 for Hugo"><link rel=stylesheet href=/2023-fall-nn-forgetting/css/vendor-bundle.min.16f785cdb553c8c4431db6775122af35.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css integrity crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=/2023-fall-nn-forgetting/css/wowchemy.312fa478a18a798c9270bab324760a16.css><link rel=stylesheet href=/2023-fall-nn-forgetting/css/libs/chroma/github-light.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/2023-fall-nn-forgetting/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"' disabled><meta name=description content="Data science methodology used to address the problem, including data preprocessing steps, exploratory data analysis, feature engineering techniques, machine learning models, and evaluation metrics."><link rel=alternate hreflang=en-us href=https://ckids-datafest.github.io/2023-fall-nn-forgetting/approach/><link rel=canonical href=https://ckids-datafest.github.io/2023-fall-nn-forgetting/approach/><link rel=manifest href=/2023-fall-nn-forgetting/manifest.webmanifest><link rel=icon type=image/png href=/2023-fall-nn-forgetting/media/icon_hu5486d42984c30aaff6be99d37062b147_3155_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/2023-fall-nn-forgetting/media/icon_hu5486d42984c30aaff6be99d37062b147_3155_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#1565c0"><meta property="twitter:card" content="summary"><meta property="twitter:site" content="@wowchemy"><meta property="twitter:creator" content="@wowchemy"><meta property="twitter:image" content="https://ckids-datafest.github.io/2023-fall-nn-forgetting/media/icon_hu5486d42984c30aaff6be99d37062b147_3155_512x512_fill_lanczos_center_3.png"><meta property="og:site_name" content="Learning and Forgetting in Neural Networks"><meta property="og:url" content="https://ckids-datafest.github.io/2023-fall-nn-forgetting/approach/"><meta property="og:title" content="Approach | Learning and Forgetting in Neural Networks"><meta property="og:description" content="Data science methodology used to address the problem, including data preprocessing steps, exploratory data analysis, feature engineering techniques, machine learning models, and evaluation metrics."><meta property="og:image" content="https://ckids-datafest.github.io/2023-fall-nn-forgetting/media/icon_hu5486d42984c30aaff6be99d37062b147_3155_512x512_fill_lanczos_center_3.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2018-06-28T00:00:00+00:00"><meta property="article:modified_time" content="2023-12-06T20:22:45-08:00"><title>Approach | Learning and Forgetting in Neural Networks</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=3e050718825977bdecb55c075afa314a><script src=/2023-fall-nn-forgetting/js/wowchemy-init.min.fe8634e7d00f14d07fb33caf14cc8e55.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/2023-fall-nn-forgetting/>Learning and Forgetting in Neural Networks</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/2023-fall-nn-forgetting/>Learning and Forgetting in Neural Networks</a></div><div class="navbar-collapse main-menu-item collapse justify-content-end" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/2023-fall-nn-forgetting/data><span>Data Assessment</span></a></li><li class=nav-item><a class=nav-link href=/2023-fall-nn-forgetting/problem-statement><span>Problem and Requirements</span></a></li><li class=nav-item><a class="nav-link active" href=/2023-fall-nn-forgetting/approach><span>Approach</span></a></li><li class=nav-item><a class=nav-link href=/2023-fall-nn-forgetting/results><span>Results</span></a></li><li class=nav-item><a class=nav-link href=/2023-fall-nn-forgetting/people><span>People</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li></ul></div></nav></header></div><div class=page-body><article class=article><div class="article-container pt-3"><h1>Approach</h1><div class=article-metadata></div></div><div class=article-container><div class=article-style><h2 id=data-preprocessing>Data Preprocessing</h2><p>a) IID Data scenario : Each model was trained on a equal share of all the classes in the dataset.</p><p>b) Non-IID Data scenario:<br>We simulate the non-IID data distribution using the following logic:</p><pre><code>  client_a : (labels == 'T-Shirt/top') | (labels == 'Trouser') | (labels == 'Pullover')
  client_b : (labels == 'Dress') | (labels == 'Coat')
  client_c : (labels == 'Sandal') | (labels == 'Shirt')
  client_d : (labels == 'Sneaker') | (labels == 'Bag') | (labels == 'Ankle Boot')
</code></pre><h2 id=model-development>Model Development</h2><p>We used the following Convolutional Neural Network for all the clients and the community model :<br></p><pre><code>   _________________________________________________________________
   Layer (type)                Output Shape              Param #   
   =================================================================
   
   fashion (InputLayer)        [(None, 28, 28, 1)]       0         
                                                                   
   conv2d_240 (Conv2D)         (None, 24, 24, 128)       3328      
                                                                   
   max_pooling2d_240 (MaxPool  (None, 12, 12, 128)       0         
   ing2D)                                                          
                                                                   
   conv2d_241 (Conv2D)         (None, 6, 6, 128)         802944    
                                                                   
   max_pooling2d_241 (MaxPool  (None, 3, 3, 128)         0         
   ing2D)                                                          
                                                                   
   flatten_120 (Flatten)       (None, 1152)              0         
                                                                   
   dense_120 (Dense)           (None, 512)               590336    
                                                                   
   predictions (Dense)         (None, 10)                5130      
                                                                   
  =================================================================
  Total params: 1401738 (5.35 MB)
  Trainable params: 1401738 (5.35 MB)
  Non-trainable params: 0 (0.00 Byte)
  _________________________________________________________________
</code></pre><p>We used Keras wrapper on Tensorflow for implementing the models. For visualization we stuck to Matplotlib and Seaborn.</p><p>For the scaffold model, each model was also equipped with client control variate for each layer to adjust for the drift. Since we had the architecture of our model fixed before hand, we could keep the vector structures of the control variates also the same as the layer weights.</p><pre><code>  class ControlVariate():
    def __init__(self):
      self.conv1_c = tensorflow.zeros((5,5,1,128))
      self.conv2_c = tensorflow.zeros((7,7,128,128))
      self.flatten1_c = tensorflow.zeros((1152,512))
      self.flatten2_c = tensorflow.zeros((512,10))
      self.pred_c = tensorflow.zeros((10,))
</code></pre><p>We implemented the suggestions laid down by the SCAFFOLD Paper with each mini-batch train step as mentioned in the algorithm outlined in the paper.<br></p><img src=scaffold_algorithm.png><h2 id=model-evaluation>Model Evaluation</h2><h3 id=a-evaluation-of-performance--br>a) Evaluation of performance :<br></h3><p>The evaluation dataset has 10000 instances of all classes to test how the clients perform on the global dataset. This enables to check if the knowledge has been transferred merely through weight transmission.</p><h3 id=b-evaluation-of-client-drift>b) Evaluation of client drift:</h3><p>The objective of this metric was to measure the client drift. We wanted to answer the question : how to visualize the drift of a model from it&rsquo;s optima? The model output is the function of the weights of the model. We take the softmax output of the last layer of the client and we extract two probability distributions: one before the local training (after the weights are distributed from the community model) and one after the local training. We then measure the KL Divergence of the two probability distributions to see how much the output distribution varies from the community model. This is essentially the catastrophic forgetting described in the earlier sections. Interesting, this is also problem in Transfer Learning: how much of the pre-trained knowledge is lost in the fine-tuning but in the case of transfer learning, it&rsquo;s core purpose and evaluation metrics lies in domain of the finetuned data. We don&rsquo;t worry that much about the pre-trained knowledge.</p><h3 id=c-visualization-of-the-class-clustering>c) Visualization of the class clustering:</h3><p>Within the dataset, certain instances pose significant challenges. To define this difficulty, consider the scenario where a shirt and a pullover exhibit remarkable similarity. The model must discern subtle distinctions between them. Our aim was to visually represent this clustering by examining the neural network&rsquo;s weight. Following each round, we fed a segment of the validation dataset through the network, capturing the activations from the final Dense layer of the CNN. We then reduced the dimensionality from 512 to 2 using t-SNE and plotted the resulting points after each round. The animated visualizations can be found in the Results section.</p></div><p class=edit-page><a href=https://github.com/ckids-datafirst/2023-fall-nn-forgetting/edit/main/content/approach/index.md><i class="fas fa-pen pr-2"></i>Edit this page</a></p></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class="powered-by copyright-license-text">© {2023} USC CKIDS DataFirst</p><p class="powered-by footer-license-icons"><a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank aria-label="Creative Commons"><i class="fab fa-creative-commons fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-by fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nc fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nd fa-2x" aria-hidden=true></i></a></p><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> — the free, <a href=https://github.com/wowchemy/wowchemy-hugo-themes target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><script src=/2023-fall-nn-forgetting/js/vendor-bundle.min.32ee83730ed883becad04bc5170512cc.js></script>
<script src=https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js integrity crossorigin=anonymous></script>
<script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script>
<script id=page-data type=application/json>{"use_headroom":true}</script><script src=/2023-fall-nn-forgetting/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js type=module></script>
<script src=/2023-fall-nn-forgetting/en/js/wowchemy.min.53e2d4aa5b5aee6f858cf53dc1025ec4.js></script>
<script src=/2023-fall-nn-forgetting/js/wowchemy-map.a26e9d2f7238ba5b868384f1c5bc6477.js type=module></script></body></html>